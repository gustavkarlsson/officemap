<div class="fixed-top-right">
	<a class="btn btn-default" href="/admin" role="button">
		<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
	</a>
</div>

<div class="container">
	<div class="page-header">
		<h1 ng-hide="!isNew()">Create person</h1>
		<h1 ng-hide="isNew()">Edit person</h1>
	</div>
	<form novalidate role="form" name="form">
		<div class="form-group">
			<label>Portrait</label>
			<div ng-file-drop ng-file-select ng-model="file" allow-dir="false" accept="image/*" style="width: 200px; max-height: 250px; cursor: pointer;" class="image-caption-container">
				<img ng-src="{{getPortraitUrl()}}" class="img-responsive" />
				<div class="caption">Click or use drag and drop to upload a portrait</div>
			</div>
			<button type="button" class="btn btn-link" ng-click="removePortrait()" ng-show="hasPortrait()">Remove</button>
		</div>
		<div class="form-group" ng-class="{ 'has-error': form.username.$invalid }">
			<label for="username">Username</label>
			<input class="form-control" id="username" name="username" placeholder="Enter username" ng-model="person.username" required>
		</div>
		<div class="form-group" ng-class="{ 'has-error': form.firstName.$invalid }">
			<label for="firstName">First name</label>
			<input class="form-control" id="firstName" name="firstName" placeholder="Enter first name" ng-model="person.firstName" required>
		</div>
		<div class="form-group" ng-class="{ 'has-error': form.lastName.$invalid }">
			<label for="lastName">Last name</label>
			<input class="form-control" id="lastName" name="lastName" placeholder="Enter last name" ng-model="person.lastName" required>
		</div>
		<div class="form-group" ng-class="{ 'has-error': form.email.$invalid }">
			<label for="email">Email address</label>
			<input class="form-control" id="email" name="email" placeholder="Enter email" ng-model="person.email" type="email" required>
		</div>
        <div class="form-group">
            <label>Location</label>
            <select class="form-control" ng-model="person.location.mapRef" ng-options="ref*1 as map.name for (ref, map) in maps" ng-change="updateLocation()">
                <option value="">No map</option>
            </select>
        </div>
        <div ng-show="person.location.mapRef" class="form-group" ng-class="{ 'has-error': form.latitude.$invalid }">
            <label for="latitude">Latitude</label>
            <input class="form-control" id="latitude" name="latitude" ng-model="person.location.latitude" type="number" ng-required="person.location.mapRef">
        </div>
        <div ng-show="person.location.mapRef" class="form-group" ng-class="{ 'has-error': form.longitude.$invalid }">
            <label for="longitude">Longitude</label>
            <input class="form-control" id="longitude" name="longitude" ng-model="person.location.longitude" type="number" ng-required="person.location.mapRef">
        </div>
		<div ng-show="isNew()">
			<button type="submit" class="btn btn-primary" ng-click="create()" ng-disabled="form.$invalid">
				<span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>&nbsp;Create
			</button>
		</div>
		<div ng-hide="isNew()">
			<button type="submit" class="btn btn-primary" ng-click="update()" ng-disabled="form.$invalid || !isChanged()">
				<span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span>&nbsp;Save
			</button>
			<button type="button" class="btn btn-warning" ng-click="revert()">&nbsp;Revert</button>
			<button type="button" class="btn btn-link pull-right" ng-click="remove()">
				<span class="glyphicon glyphicon-trash" aria-hidden="true"></span>&nbsp;Delete
			</button>
		</div>
	</form>
</div>
